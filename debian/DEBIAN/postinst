#!/bin/bash
set -e

# Eksik bagimliliklari otomatik kur
if command -v apt-get &>/dev/null; then
    apt-get install -f -y 2>/dev/null || true
fi

# Desktop veritabanini guncelle
if command -v update-desktop-database &>/dev/null; then
    update-desktop-database -q /usr/share/applications/ 2>/dev/null || true
fi

# Icon cache guncelle
if command -v gtk-update-icon-cache &>/dev/null; then
    gtk-update-icon-cache -q /usr/share/icons/hicolor/ 2>/dev/null || true
fi

# Calistirilabilir yap
chmod +x /usr/share/okul-mesajlasma/okul_mesajlasma
chmod +x /usr/share/okul-mesajlasma/launch.sh

echo "Okul Mesajlasma Sistemi basariyla kuruldu."
